# ConvertingNotes
Приложение по определению нот фортепьяно (без четвертей и половинок - базовое определение) и соотношение их с нотами глюкофона (тональным язычковым барабаном, 15 нот, до мажор) Запись отрывка нотного стана в изображении в цифровой тональности глюкофона (у него вместо нот цифры).

<img width="974" height="764" alt="image" src="https://github.com/user-attachments/assets/14ff31d3-8cf7-4770-a35a-4225bbf1c9f2" />

**Проблема:**

Отсутствие нот русских известных песен для относительного нового музыкального инструмента – глюкофона.

**Решение:** 

Создать и обучить ИИ модель на базе, например, yolo распознавать в картинках нотного стана ноты и соотносить их с нотами глюкофона. При этом с возможностью записи конвертированных нот в отдельный файл для дальнейшего использования в личных целях.

**Проделано:**

1.	Изучен нотный стан и расположение нот. Проанализирована тональность нот глюкофона и соотнесена с нотами фортепьяно.
   
2.	На основании анализа проведена разметка 80+ случайных картинок из интернета с отрывками партитур различных известных русских музыкальных произведений.
   
3.	На основании размеченных данных проведено обучение модели yolo5 (30 эпох) и получены высокие показатели обучения (mAP50 = 0.969, mAP50-95 = 0.571, cls_loss = 0.98, Recall (R) = 0.944).
   
4.	Проведен анализ результатов распознавания новых файлов (картинок) и создана матрица ошибок, которая также показала высокую эффективность модели.
   
5.	Создан скрипт приложения с распознаванием нот и проведена компиляция (сборка файлов в .exe файл для дальнейшего использование.

**Структура файлов:**

**source_data** – папка с размеченными данными

**dataset** – папка с данными для тестовой, тренировочной и валидационной выборок

**runs** – папка с результатами обучения

**prepare_data.py** – скрипт разбивки картинок для тестовой, тренировочной и валидационной выборок

**train_yolo.py** – скрипт обучения модели

**check_result.py** - cкрипт для массовой проверки новых фото с записью результатов и построением матрицы ошибок и графиков (F1, precisions, recall, confidence)

**check.py** – скрипт промежуточной проверки модели

**app.py** – скрипт приложения с внутренней моделью и весами



**Ниже изображены полученные графики из пункта 4 при анализе эффективности  обучения**

На графиках видны яркие диагональные линии. Это показатель того, что модель
правильно сопоставляет классы.




<img width="2250" height="1500" alt="BoxF1_curve" src="https://github.com/user-attachments/assets/f47cc57b-942f-40f7-b2c8-4b0ae62d902a" />

<img width="2250" height="1500" alt="BoxP_curve" src="https://github.com/user-attachments/assets/015dd35c-f017-43d4-b764-507d651d835d" />

<img width="2250" height="1500" alt="BoxPR_curve" src="https://github.com/user-attachments/assets/bd0290a7-24c5-43c7-ae0b-4c2ef54a78a8" />

<img width="2250" height="1500" alt="BoxR_curve" src="https://github.com/user-attachments/assets/cd042a15-9c0a-444c-8e07-228347cd34bb" />


**Анализ матрицы ошибок**

Матрица ошибок показывает, какие классы модель определяет правильно
(яркая диагональ) и какие путает (цифры вне диагонали).

**Высокая точность (Сильная диагональ):** Подавляющее большинство
предсказаний сосредоточено на главной диагонали. Например, для
класса «4.» из 132 предсказаний все оказались верными; для класса «1.»
83 из 84 предсказаний верны. Это подтверждает ваши высокие метрики
mAP50 (97%).

**Минимальные ошибки:** Вне диагонали встречаются лишь единичные
случаи ошибок. Например, 1 объект класса «1.» был предсказан как
класс «7.», или 1 объект класса «3.» был предсказан как класс «7.». Это
очень незначительные ошибки.


<img width="3000" height="2250" alt="confusion_matrix" src="https://github.com/user-attachments/assets/880c20c2-f03f-41d6-b822-6b38e9fdadab" />

<img width="3000" height="2250" alt="confusion_matrix_normalized" src="https://github.com/user-attachments/assets/33a98167-174e-4cbb-8c3a-9aa41486fbd4" />

**Общий вывод:** Модель работает очень точно и готова к использованию.
Она отлично различает большинство классов и почти не путает
похожие символы



**Распознование новых картинок**

При просмотре обращали внимание на: 

1. Точность меток: Насколько правильно модель ставит классы
   
2. Плотность: Находит ли она объекты в самых кучных местах (где их по 80
штук).

3. Ложные срабатывания: Нет ли рамок там, где на самом деле пусто.
   

**несколько картинок для примера**


![photo(26)](https://github.com/user-attachments/assets/163a4ff3-3390-4c88-b6d8-2663e52a9f27)

![photo(66)](https://github.com/user-attachments/assets/cb55d374-1e69-4b48-8a33-e455f0b6aa86)

